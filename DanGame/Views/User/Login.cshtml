@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model dynamic;
@{
    ViewBag.Title = "Login";
    Layout = "_Layout";
}
<div style="padding-top: 4rem; background-image: linear-gradient(to right, rgba(238, 162, 162, 0.5) 0%, rgba(187, 193, 191, 0.5) 19%, rgba(87, 198, 225, 0.5) 42%, rgba(180, 159, 218, 0.5) 79%, rgba(122, 197, 216, 0.5) 100%); height: 100vh;">
    <div class="d-flex justify-content-center align-items-center" style="height: 100%;">
        <div class="border container d-flex flex-column" style="background-color: white; padding: 2rem;">
            <br>
        <form method="post" asp-controller="User" asp-action="Login">
            <input id="redirectTo" name="redirectTo" value="@(Model?.redirectTo != null ? $"{System.Web.HttpUtility.UrlDecode(Model.redirectTo)}" : "")" hidden>
                <div class="p-2">
                    <label for="useremail">帳號：</label>
                <input type="text" id="useremail" name="useremail" pattern="[a-zA-Z0-9._%+-]+@@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}" title="請輸入有效的電子郵件地址，如 example@example.com"
                        required>
                </div>
                <div class="p-2">
                    <label for="password">密碼：</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <!-- 
                    <form id="loginForm">
                <div class="p-2">
                    <label for="account">帳號：</label>
                    <input type="text" id="account" name="account" pattern="\w+([.-]?\w+)*@@\w+([.-]?\w+)*(\.\w{2,3})+" required>
                </div>
                <div class="p-2">
                    <label for="password">密碼：</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div class="p-2">
                    <label for="">驗證碼：</label>
                    <input type="text" name="" id="">
                </div>
                <div class="p-2">
                    <img id="captcha-img" class="" src="https://picsum.photos/200/100?random=" alt="">
                    <button class="btn btn-primary" onclick="refreshCaptcha()">重新整理</button>
                </div>
                <div class="p-2">
                    <a href="./forget_pw.html">忘記密碼</a>
                    <a href="./register.html">註冊</a>
                </div>
                <div class="p-2">
                    <button type="button" class="btn btn-primary" onclick="submitLogin()">登入</button>
                </div>
                </form>
                -->
                <div class="p-2" style="margin-left: 110px">
                    @Html.ActionLink("忘記密碼", "ForgetPwd", "User")
                    <a asp-controller="User" asp-action="Register" style="padding-left: 20px;">註冊</a>
                </div>
                <div class="p-2">
                    <button type="submit" class="btn btn-primary">登入</button>
                </div>
            </form>
            @if (ViewBag.ErrorMessage != null)
            {
                <div>
                    <span style="color:red;">@ViewBag.ErrorMessage</span>
                </div>
            }
        </div>
    </div>
</div>
    <script>
        /*
        function validateForm() {
            var accountInput = document.getElementById('account');
            var pattern = new RegExp(accountInput.pattern);
            if (!pattern.test(accountInput.value)) {
                alert('請輸入有效的電子郵件地址！');
                return false;
            }

            // AJAX 提交表單
            var account = document.getElementById('account').value;
            var password = document.getElementById('password').value;

            $.ajax({
                url: '/login', // 後端處理登錄的API路徑
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ account: account, password: password }),
                success: function (response) {
                    if (response.success) {
                        window.location.href = './account_set.html';
                    } else {
                        alert('帳號或密碼錯誤');
                    }
                },
                error: function () {
                    alert('登錄過程中出現錯誤');
                }
            });

            return false; // 阻止表單默認提交
        }
        */

        // function refreshCaptcha() {
        //     var randomNumber = Math.floor(Math.random() * 1000); // 生成一個 0 到 999 的隨機數
        //     var captchaImg = document.getElementById("captcha-img");
        //     captchaImg.src = "https://picsum.photos/200/100?random=" + randomNumber; // 使用 Picsum 圖片服務生成亂數圖片
        // }
    </script>
